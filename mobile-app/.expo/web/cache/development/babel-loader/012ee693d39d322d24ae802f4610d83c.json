{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport NativeModules from \"react-native-web/dist/exports/NativeModules\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport findNodeHandle from \"react-native-web/dist/exports/findNodeHandle\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar RNViewShot = NativeModules.RNViewShot;\nvar neverEndingPromise = new Promise(function () {});\n\nif (!RNViewShot) {\n  console.warn(\"react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.\");\n}\n\nvar acceptedFormats = [\"png\", \"jpg\"].concat(Platform.OS === \"android\" ? [\"webm\", \"raw\"] : []);\nvar acceptedResults = [\"tmpfile\", \"base64\", \"data-uri\"].concat(Platform.OS === \"android\" ? [\"zip-base64\"] : []);\nvar defaultOptions = {\n  format: \"png\",\n  quality: 1,\n  result: \"tmpfile\",\n  snapshotContentContainer: false\n};\n\nfunction validateOptions(input) {\n  var options = _objectSpread(_objectSpread({}, defaultOptions), input);\n\n  var errors = [];\n\n  if (\"width\" in options && (typeof options.width !== \"number\" || options.width <= 0)) {\n    errors.push(\"option width should be a positive number\");\n    delete options.width;\n  }\n\n  if (\"height\" in options && (typeof options.height !== \"number\" || options.height <= 0)) {\n    errors.push(\"option height should be a positive number\");\n    delete options.height;\n  }\n\n  if (typeof options.quality !== \"number\" || options.quality < 0 || options.quality > 1) {\n    errors.push(\"option quality should be a number between 0.0 and 1.0\");\n    options.quality = defaultOptions.quality;\n  }\n\n  if (typeof options.snapshotContentContainer !== \"boolean\") {\n    errors.push(\"option snapshotContentContainer should be a boolean\");\n  }\n\n  if (acceptedFormats.indexOf(options.format) === -1) {\n    options.format = defaultOptions.format;\n    errors.push(\"option format '\" + options.format + \"' is not in valid formats: \" + acceptedFormats.join(\" | \"));\n  }\n\n  if (acceptedResults.indexOf(options.result) === -1) {\n    options.result = defaultOptions.result;\n    errors.push(\"option result '\" + options.result + \"' is not in valid formats: \" + acceptedResults.join(\" | \"));\n  }\n\n  return {\n    options: options,\n    errors: errors\n  };\n}\n\nexport function ensureModuleIsLoaded() {\n  if (!RNViewShot) {\n    throw new Error(\"react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.\");\n  }\n}\nexport function captureRef(view, optionsObject) {\n  ensureModuleIsLoaded();\n\n  if (view && typeof view === \"object\" && \"current\" in view && view.current) {\n    view = view.current;\n\n    if (!view) {\n      return Promise.reject(new Error(\"ref.current is null\"));\n    }\n  }\n\n  if (typeof view !== \"number\") {\n    var node = findNodeHandle(view);\n\n    if (!node) {\n      return Promise.reject(new Error(\"findNodeHandle failed to resolve view=\" + String(view)));\n    }\n\n    view = node;\n  }\n\n  var _validateOptions = validateOptions(optionsObject),\n      options = _validateOptions.options,\n      errors = _validateOptions.errors;\n\n  if (__DEV__ && errors.length > 0) {\n    console.warn(\"react-native-view-shot: bad options:\\n\" + errors.map(function (e) {\n      return \"- \" + e;\n    }).join(\"\\n\"));\n  }\n\n  return RNViewShot.captureRef(view, options);\n}\nexport function releaseCapture(uri) {\n  if (typeof uri !== \"string\") {\n    if (__DEV__) {\n      console.warn(\"Invalid argument to releaseCapture. Got: \" + uri);\n    }\n  } else {\n    RNViewShot.releaseCapture(uri);\n  }\n}\nexport function captureScreen(optionsObject) {\n  ensureModuleIsLoaded();\n\n  var _validateOptions2 = validateOptions(optionsObject),\n      options = _validateOptions2.options,\n      errors = _validateOptions2.errors;\n\n  if (__DEV__ && errors.length > 0) {\n    console.warn(\"react-native-view-shot: bad options:\\n\" + errors.map(function (e) {\n      return \"- \" + e;\n    }).join(\"\\n\"));\n  }\n\n  return RNViewShot.captureScreen(options);\n}\n\nfunction checkCompatibleProps(props) {\n  if (!props.captureMode && props.onCapture) {} else if (props.captureMode && !props.onCapture) {\n    console.warn(\"react-native-view-shot: captureMode prop is defined but onCapture prop callback is missing\");\n  } else if ((props.captureMode === \"continuous\" || props.captureMode === \"update\") && props.options && props.options.result && props.options.result !== \"tmpfile\") {\n    console.warn(\"react-native-view-shot: result=tmpfile is recommended for captureMode=\" + props.captureMode);\n  }\n}\n\nvar ViewShot = function (_Component) {\n  _inherits(ViewShot, _Component);\n\n  var _super = _createSuper(ViewShot);\n\n  function ViewShot() {\n    var _this;\n\n    _classCallCheck(this, ViewShot);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.firstLayoutPromise = new Promise(function (resolve) {\n      _this.resolveFirstLayout = resolve;\n    });\n\n    _this.capture = function () {\n      return _this.firstLayoutPromise.then(function () {\n        var _assertThisInitialize = _assertThisInitialized(_this),\n            root = _assertThisInitialize.root;\n\n        if (!root) return neverEndingPromise;\n        return captureRef(root, _this.props.options);\n      }).then(function (uri) {\n        _this.onCapture(uri);\n\n        return uri;\n      }, function (e) {\n        _this.onCaptureFailure(e);\n\n        throw e;\n      });\n    };\n\n    _this.onCapture = function (uri) {\n      if (!_this.root) return;\n\n      if (_this.lastCapturedURI) {\n        setTimeout(releaseCapture, 500, _this.lastCapturedURI);\n      }\n\n      _this.lastCapturedURI = uri;\n      var onCapture = _this.props.onCapture;\n      if (onCapture) onCapture(uri);\n    };\n\n    _this.onCaptureFailure = function (e) {\n      if (!_this.root) return;\n      var onCaptureFailure = _this.props.onCaptureFailure;\n      if (onCaptureFailure) onCaptureFailure(e);\n    };\n\n    _this.syncCaptureLoop = function (captureMode) {\n      cancelAnimationFrame(_this._raf);\n\n      if (captureMode === \"continuous\") {\n        var previousCaptureURI = \"-\";\n\n        var loop = function loop() {\n          _this._raf = requestAnimationFrame(loop);\n          if (previousCaptureURI === _this.lastCapturedURI) return;\n          previousCaptureURI = _this.lastCapturedURI;\n\n          _this.capture();\n        };\n\n        _this._raf = requestAnimationFrame(loop);\n      }\n    };\n\n    _this.onRef = function (ref) {\n      _this.root = ref;\n    };\n\n    _this.onLayout = function (e) {\n      var onLayout = _this.props.onLayout;\n\n      _this.resolveFirstLayout(e.nativeEvent.layout);\n\n      if (onLayout) onLayout(e);\n    };\n\n    return _this;\n  }\n\n  _createClass(ViewShot, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (__DEV__) checkCompatibleProps(this.props);\n\n      if (this.props.captureMode === \"mount\") {\n        this.capture();\n      } else {\n        this.syncCaptureLoop(this.props.captureMode);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.captureMode !== undefined) {\n        if (this.props.captureMode !== prevProps.captureMode) {\n          this.syncCaptureLoop(this.props.captureMode);\n        }\n      }\n\n      if (this.props.captureMode === \"update\") {\n        this.capture();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.syncCaptureLoop(null);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      return _jsx(View, {\n        ref: this.onRef,\n        collapsable: false,\n        onLayout: this.onLayout,\n        style: this.props.style,\n        children: children\n      });\n    }\n  }]);\n\n  return ViewShot;\n}(Component);\n\nViewShot.captureRef = captureRef;\nViewShot.releaseCapture = releaseCapture;\nexport { ViewShot as default };","map":{"version":3,"sources":["/Users/weiherr/Desktop/FYP/MyRecycle/mobile-app/node_modules/react-native-view-shot/src/index.js"],"names":["React","Component","RNViewShot","NativeModules","neverEndingPromise","Promise","console","warn","acceptedFormats","concat","Platform","OS","acceptedResults","defaultOptions","format","quality","result","snapshotContentContainer","validateOptions","input","options","errors","width","push","height","indexOf","join","ensureModuleIsLoaded","Error","captureRef","view","optionsObject","current","reject","node","findNodeHandle","String","__DEV__","length","map","e","releaseCapture","uri","captureScreen","checkCompatibleProps","props","captureMode","onCapture","ViewShot","firstLayoutPromise","resolve","resolveFirstLayout","capture","then","root","onCaptureFailure","lastCapturedURI","setTimeout","syncCaptureLoop","cancelAnimationFrame","_raf","previousCaptureURI","loop","requestAnimationFrame","onRef","ref","onLayout","nativeEvent","layout","prevProps","undefined","children","style"],"mappings":"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","sourcesContent":["// @flow\nimport React, { Component } from \"react\";\nimport { View, NativeModules, Platform, findNodeHandle } from \"react-native\";\nconst { RNViewShot } = NativeModules;\nimport type { ViewStyleProp } from \"react-native/Libraries/StyleSheet/StyleSheet\";\nimport type { LayoutEvent } from \"react-native/Libraries/Types/CoreEventTypes\";\n\nconst neverEndingPromise = new Promise(() => {});\n\ntype Options = {\n  width?: number,\n  height?: number,\n  format: \"png\" | \"jpg\" | \"webm\" | \"raw\",\n  quality: number,\n  result: \"tmpfile\" | \"base64\" | \"data-uri\" | \"zip-base64\",\n  snapshotContentContainer: boolean\n};\n\nif (!RNViewShot) {\n  console.warn(\n    \"react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.\"\n  );\n}\n\nconst acceptedFormats = [\"png\", \"jpg\"].concat(\n  Platform.OS === \"android\" ? [\"webm\", \"raw\"] : []\n);\n\nconst acceptedResults = [\"tmpfile\", \"base64\", \"data-uri\"].concat(\n  Platform.OS === \"android\" ? [\"zip-base64\"] : []\n);\n\nconst defaultOptions = {\n  format: \"png\",\n  quality: 1,\n  result: \"tmpfile\",\n  snapshotContentContainer: false\n};\n\n// validate and coerce options\nfunction validateOptions(\n  input: ?$Shape<Options>\n): { options: Options, errors: Array<string> } {\n  const options: Options = {\n    ...defaultOptions,\n    ...input\n  };\n  const errors = [];\n  if (\n    \"width\" in options &&\n    (typeof options.width !== \"number\" || options.width <= 0)\n  ) {\n    errors.push(\"option width should be a positive number\");\n    delete options.width;\n  }\n  if (\n    \"height\" in options &&\n    (typeof options.height !== \"number\" || options.height <= 0)\n  ) {\n    errors.push(\"option height should be a positive number\");\n    delete options.height;\n  }\n  if (\n    typeof options.quality !== \"number\" ||\n    options.quality < 0 ||\n    options.quality > 1\n  ) {\n    errors.push(\"option quality should be a number between 0.0 and 1.0\");\n    options.quality = defaultOptions.quality;\n  }\n  if (typeof options.snapshotContentContainer !== \"boolean\") {\n    errors.push(\"option snapshotContentContainer should be a boolean\");\n  }\n  if (acceptedFormats.indexOf(options.format) === -1) {\n    options.format = defaultOptions.format;\n    errors.push(\n      \"option format '\" +\n        options.format +\n        \"' is not in valid formats: \" +\n        acceptedFormats.join(\" | \")\n    );\n  }\n  if (acceptedResults.indexOf(options.result) === -1) {\n    options.result = defaultOptions.result;\n    errors.push(\n      \"option result '\" +\n        options.result +\n        \"' is not in valid formats: \" +\n        acceptedResults.join(\" | \")\n    );\n  }\n  return { options, errors };\n}\n\nexport function ensureModuleIsLoaded() {\n  if (!RNViewShot) {\n    throw new Error(\n      \"react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.\"\n    );\n  }\n}\n\nexport function captureRef<T: React$ElementType>(\n  view: number | ?View | React$Ref<T>,\n  optionsObject?: Object\n): Promise<string> {\n  ensureModuleIsLoaded();\n  if (\n    view &&\n    typeof view === \"object\" &&\n    \"current\" in view &&\n    // $FlowFixMe view is a ref\n    view.current\n  ) {\n    // $FlowFixMe view is a ref\n    view = view.current;\n    if (!view) {\n      return Promise.reject(new Error(\"ref.current is null\"));\n    }\n  }\n  if (typeof view !== \"number\") {\n    const node = findNodeHandle(view);\n    if (!node) {\n      return Promise.reject(\n        new Error(\"findNodeHandle failed to resolve view=\" + String(view))\n      );\n    }\n    view = node;\n  }\n  const { options, errors } = validateOptions(optionsObject);\n  if (__DEV__ && errors.length > 0) {\n    console.warn(\n      \"react-native-view-shot: bad options:\\n\" +\n        errors.map(e => `- ${e}`).join(\"\\n\")\n    );\n  }\n  return RNViewShot.captureRef(view, options);\n}\n\nexport function releaseCapture(uri: string): void {\n  if (typeof uri !== \"string\") {\n    if (__DEV__) {\n      console.warn(\"Invalid argument to releaseCapture. Got: \" + uri);\n    }\n  } else {\n    RNViewShot.releaseCapture(uri);\n  }\n}\n\nexport function captureScreen(optionsObject?: Options): Promise<string> {\n  ensureModuleIsLoaded();\n  const { options, errors } = validateOptions(optionsObject);\n  if (__DEV__ && errors.length > 0) {\n    console.warn(\n      \"react-native-view-shot: bad options:\\n\" +\n        errors.map(e => `- ${e}`).join(\"\\n\")\n    );\n  }\n  return RNViewShot.captureScreen(options);\n}\n\ntype Props = {\n  options?: Object,\n  captureMode?: \"mount\" | \"continuous\" | \"update\",\n  children: React$Node,\n  onLayout?: (e: *) => void,\n  onCapture?: (uri: string) => void,\n  onCaptureFailure?: (e: Error) => void,\n  style?: ViewStyleProp\n};\n\nfunction checkCompatibleProps(props: Props) {\n  if (!props.captureMode && props.onCapture) {\n    // in that case, it's authorized if you call capture() yourself\n  } else if (props.captureMode && !props.onCapture) {\n    console.warn(\n      \"react-native-view-shot: captureMode prop is defined but onCapture prop callback is missing\"\n    );\n  } else if (\n    (props.captureMode === \"continuous\" || props.captureMode === \"update\") &&\n    props.options &&\n    props.options.result &&\n    props.options.result !== \"tmpfile\"\n  ) {\n    console.warn(\n      \"react-native-view-shot: result=tmpfile is recommended for captureMode=\" +\n        props.captureMode\n    );\n  }\n}\n\nexport default class ViewShot extends Component<Props> {\n  static captureRef = captureRef;\n  static releaseCapture = releaseCapture;\n\n  root: ?View;\n\n  _raf: *;\n  lastCapturedURI: ?string;\n\n  resolveFirstLayout: (layout: Object) => void;\n  firstLayoutPromise: Promise<Object> = new Promise(resolve => {\n    this.resolveFirstLayout = resolve;\n  });\n\n  capture = (): Promise<string> =>\n    this.firstLayoutPromise\n      .then(() => {\n        const { root } = this;\n        if (!root) return neverEndingPromise; // component is unmounted, you never want to hear back from the promise\n        return captureRef(root, this.props.options);\n      })\n      .then(\n        (uri: string) => {\n          this.onCapture(uri);\n          return uri;\n        },\n        (e: Error) => {\n          this.onCaptureFailure(e);\n          throw e;\n        }\n      );\n\n  onCapture = (uri: string) => {\n    if (!this.root) return;\n    if (this.lastCapturedURI) {\n      // schedule releasing the previous capture\n      setTimeout(releaseCapture, 500, this.lastCapturedURI);\n    }\n    this.lastCapturedURI = uri;\n    const { onCapture } = this.props;\n    if (onCapture) onCapture(uri);\n  };\n\n  onCaptureFailure = (e: Error) => {\n    if (!this.root) return;\n    const { onCaptureFailure } = this.props;\n    if (onCaptureFailure) onCaptureFailure(e);\n  };\n\n  syncCaptureLoop = (captureMode: ?string) => {\n    cancelAnimationFrame(this._raf);\n    if (captureMode === \"continuous\") {\n      let previousCaptureURI = \"-\"; // needs to capture at least once at first, so we use \"-\" arbitrary string\n      const loop = () => {\n        this._raf = requestAnimationFrame(loop);\n        if (previousCaptureURI === this.lastCapturedURI) return; // previous capture has not finished, don't capture yet\n        previousCaptureURI = this.lastCapturedURI;\n        this.capture();\n      };\n      this._raf = requestAnimationFrame(loop);\n    }\n  };\n\n  onRef = (ref: React$ElementRef<*>) => {\n    this.root = ref;\n  };\n\n  onLayout = (e: LayoutEvent) => {\n    const { onLayout } = this.props;\n    this.resolveFirstLayout(e.nativeEvent.layout);\n    if (onLayout) onLayout(e);\n  };\n\n  componentDidMount() {\n    if (__DEV__) checkCompatibleProps(this.props);\n    if (this.props.captureMode === \"mount\") {\n      this.capture();\n    } else {\n      this.syncCaptureLoop(this.props.captureMode);\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.captureMode !== undefined) {\n      if (this.props.captureMode !== prevProps.captureMode) {\n        this.syncCaptureLoop(this.props.captureMode);\n      }\n    }\n    if (this.props.captureMode === \"update\") {\n      this.capture();\n    }\n  }\n\n  componentWillUnmount() {\n    this.syncCaptureLoop(null);\n  }\n\n  render() {\n    const { children } = this.props;\n    return (\n      <View\n        ref={this.onRef}\n        collapsable={false}\n        onLayout={this.onLayout}\n        style={this.props.style}\n      >\n        {children}\n      </View>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}